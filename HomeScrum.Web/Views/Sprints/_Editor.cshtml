@using HomeScrum.Web.Extensions

@model HomeScrum.Web.Models.Sprints.SprintEditorViewModel

@{
   ViewBag.SprintId = Model.Id;
}

@using (Html.BeginForm())
{
   <fieldset>
      <legend>Basic Information</legend>

      <div class="formSingleLineEdit">
         @Html.LabelFor( model => model.Name )
         <span>@Html.EditorFor( model => model.Name )</span>
         @Html.ValidationMessageFor( model => model.Name )
      </div>

      <div class="formSingleLineEdit">
         @Html.LabelFor( model => model.Goal )
         <span>@Html.EditorFor( model => model.Goal )</span>
         @Html.ValidationMessageFor( model => model.Goal )
      </div>

      <div class="formLongText">
         @Html.LabelFor( model => model.Description )
         <span>@Html.EditorFor( model => model.Description )</span>
         @Html.ValidationMessageFor( model => model.Description )
      </div>

      @Html.HiddenFor( m => m.CreatedByUserId )
      @Html.HiddenFor( m => m.CreatedByUserUserName )

   </fieldset>

   <fieldset>
      <legend>Properties</legend>

      <div class="formSelectList">
         @Html.LabelFor( model => model.ProjectId )
         @Html.DropDownListFor( model => model.SelectProjectId, Model.Projects )
         @Html.HiddenFor( model => model.ProjectId )
      </div>

      <div class="formSelectList">
         @Html.LabelFor( model => model.StatusId )
         @Html.DropDownListWithDataAttributesFor( model => model.StatusId, Model.Statuses )
      </div>

      <div class="formSelectList">
         @Html.LabelFor( model => model.StartDate )
         @Html.EditorFor( model => model.StartDate )
         @Html.ValidationMessageFor( model => model.StartDate )
      </div>

      <div class="formSelectList">
         @Html.LabelFor( model => model.EndDate )
         @Html.EditorFor( model => model.EndDate )
         @Html.ValidationMessageFor( model => model.EndDate )
      </div>
   </fieldset>

   if (Model.Id != Guid.Empty)
   {
      <fieldset>
         <legend>WorkItems</legend>

         <div id="BacklogItems">
            <h3>Backlog Items</h3>
            @Html.Partial( "_WorkItemList", Model.BacklogItems )
            @Html.ActionLink( "Select Backlog Items", "AddBacklogItems", new { Id = Model.Id, callingId = Model.Id.ToString(), callingAction = "Edit" }, new { id = "BacklogLink" } )
         </div>

         <div id="Tasks">
            <h3>Tasks</h3>
            @Html.Partial( "_WorkItemList", Model.Tasks )
            @Html.ActionLink( "Select Tasks", "AddTasks", new { Id = Model.Id, callingId = Model.Id, callingAction = "Edit" }, new { id = "TaskListLink" } )
         </div>
      </fieldset>
   }

   @Html.ValidationSummary( false )

   <p>
      <input type="submit" value="@ViewBag.EditorButtonLabel" />
   </p>

   @Scripts.Render( "~/bundles/sprintScripts" )
   
   <script>
      $(document).ready(function () {
         Editor.init();

         $("#StartDate").datepicker({
            changeMonth: true,
            changeYear: true
         });
         $("#EndDate").datepicker({
            changeMonth: true,
            changeYear: true
         });
      });
   </script>
}